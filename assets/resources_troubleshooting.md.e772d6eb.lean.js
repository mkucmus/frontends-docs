import{_ as e,k as o,F as s,W as n}from"./chunks/framework.e8799e72.js";const a=JSON.parse('{"title":"Troubleshooting","description":"","frontmatter":{"head":[["meta",{"name":"og:title","content":"Troubleshooting - Shopware Composable Frontends"}],["meta",{"name":"og:description","content":"Collection of common issues you may run into while working with Shopware Composable Frontends."}],["meta",{"name":"og:image","content":"https://frontends-og-image.vercel.app/Troubleshooting?fontSize=150px"}]]},"headers":[{"level":2,"title":"Which SalesChannel type to use for Composable Frontends?","slug":"which-saleschannel-type-to-use-for-composable-frontends","link":"#which-saleschannel-type-to-use-for-composable-frontends","children":[]},{"level":2,"title":"How to use https for your localhost with Composable Frontends?","slug":"how-to-use-https-for-your-localhost-with-composable-frontends","link":"#how-to-use-https-for-your-localhost-with-composable-frontends","children":[{"level":3,"title":"Option 1: Manual with mkcert","slug":"option-1-manual-with-mkcert","link":"#option-1-manual-with-mkcert","children":[]},{"level":3,"title":"Option 2: Vite plugin","slug":"option-2-vite-plugin","link":"#option-2-vite-plugin","children":[]}]},{"level":2,"title":"SSR throws error in local environment with DDEV?","slug":"ssr-throws-error-in-local-environment-with-ddev","link":"#ssr-throws-error-in-local-environment-with-ddev","children":[]},{"level":2,"title":"412 error page during local development?","slug":"_412-error-page-during-local-development","link":"#_412-error-page-during-local-development","children":[]},{"level":2,"title":"Access from origin 127.0.0.1:3000 has been blocked by CORS policy","slug":"access-from-origin-127-0-0-1-3000-has-been-blocked-by-cors-policy","link":"#access-from-origin-127-0-0-1-3000-has-been-blocked-by-cors-policy","children":[]},{"level":2,"title":"Proxy API requests","slug":"proxy-api-requests","link":"#proxy-api-requests","children":[{"level":3,"title":"Nuxt example","slug":"nuxt-example","link":"#nuxt-example","children":[]}]}],"relativePath":"resources/troubleshooting.md","filePath":"resources/troubleshooting.md"}'),t={name:"resources/troubleshooting.md"},l=[n('<h1 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h1><p>Collection of common issues you may run into while working with Shopware Composable Frontends. If you need help or have other questions, feel free to join the <a href="https://shopwarecommunity.slack.com/archives/C050L6NCMGQ" target="_blank" rel="noreferrer">frontends slack channel</a>.</p><h2 id="which-saleschannel-type-to-use-for-composable-frontends" tabindex="-1">Which SalesChannel type to use for Composable Frontends? <a class="header-anchor" href="#which-saleschannel-type-to-use-for-composable-frontends" aria-label="Permalink to &quot;Which SalesChannel type to use for Composable Frontends?&quot;">​</a></h2><p>Currently you should use the default <strong>Storefront SalesChannel type</strong>. This sounds wrong, but if you using the Headless SalesChannel type you will not have nice speaking seo urls at the moment. Because the generation of seo urls will only be executed for SalesChannels with the type Storefront. We working on a more flexible solution with the core team to not have this confusion in the future.</p><h2 id="how-to-use-https-for-your-localhost-with-composable-frontends" tabindex="-1">How to use https for your localhost with Composable Frontends? <a class="header-anchor" href="#how-to-use-https-for-your-localhost-with-composable-frontends" aria-label="Permalink to &quot;How to use https for your localhost with Composable Frontends?&quot;">​</a></h2><h3 id="option-1-manual-with-mkcert" tabindex="-1">Option 1: Manual with mkcert <a class="header-anchor" href="#option-1-manual-with-mkcert" aria-label="Permalink to &quot;Option 1: Manual with mkcert&quot;">​</a></h3><ul><li>Make sure you have <code>mkcert</code> installed on your system. Otherwise, follow <a href="https://github.com/FiloSottile/mkcert" target="_blank" rel="noreferrer">here</a> to set it up.</li><li>Create a valid certificate in your project folder by running <code>mkcert localhost</code>.</li><li>Update the <code>nuxt dev</code> command in your <code>package.json</code>.<br> It should look like this: <code>NODE_TLS_REJECT_UNAUTHORIZED=0 nuxt dev --https --ssl-cert localhost.pem --ssl-key localhost-key.pem</code></li><li>Now run your project with <code>npm run dev</code> or <code>pnpm run dev</code> from your project root.</li><li>Your browser may ask you to accept the risk when you visit <a href="https://localhost:3000" target="_blank" rel="noreferrer">https://localhost:3000</a>. This is because it is a self-signed certificate.</li></ul><h3 id="option-2-vite-plugin" tabindex="-1">Option 2: Vite plugin <a class="header-anchor" href="#option-2-vite-plugin" aria-label="Permalink to &quot;Option 2: Vite plugin&quot;">​</a></h3><ul><li>Execute <code>pnpm add -D @vitejs/plugin-basic-ssl</code> in your project folder</li><li>Edit your <code>nuxt.config.ts</code> file and add:<div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> basicSsl </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@vitejs/plugin-basic-ssl</span><span style="color:#89DDFF;">&#39;</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">// https://v3.nuxtjs.org/docs/directory-structure/nuxt.config</span></span>\n<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">defineNuxtConfig</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">// ...</span></span>\n<span class="line"><span style="color:#F07178;">devServer</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">https</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>\n<span class="line"><span style="color:#89DDFF;">},</span></span>\n<span class="line"><span style="color:#F07178;">vite</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">plugins</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">basicSsl</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span></span>\n<span class="line"><span style="color:#A6ACCD;">  ]</span><span style="color:#89DDFF;">,</span></span>\n<span class="line"><span style="color:#89DDFF;">},</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">// ...</span></span>\n<span class="line"></span></code></pre></div></li><li>Start your dev server with <code>pnpm run dev</code></li><li>Your browser may ask you to accept the risk when you visit <a href="https://localhost:3000" target="_blank" rel="noreferrer">https://localhost:3000</a>. This is because it is a self-signed certificate.</li></ul><h2 id="ssr-throws-error-in-local-environment-with-ddev" tabindex="-1">SSR throws error in local environment with DDEV? <a class="header-anchor" href="#ssr-throws-error-in-local-environment-with-ddev" aria-label="Permalink to &quot;SSR throws error in local environment with DDEV?&quot;">​</a></h2><p>If you are using DDEV as a local environment with SSR = true (Nuxt config for routes) and you always get a 500 error message that the context is not provided for category, you may have a problem with the SSL certificate. Try to use <code>NODE_TLS_REJECT_UNAUTHORIZED = 0</code> in <a href="https://nuxt.com/docs/guide/directory-structure/env" target="_blank" rel="noreferrer">.env file</a> (this is a issue with self-signed certificates). To validate if this is your problem: Connect the local Frontend with a valid SSL from a cloud instance and check it against this instance. Also check if you can reach any local store API endpoint with some API client.</p><h2 id="_412-error-page-during-local-development" tabindex="-1">412 error page during local development? <a class="header-anchor" href="#_412-error-page-during-local-development" aria-label="Permalink to &quot;412 error page during local development?&quot;">​</a></h2><p>The HTTP status code 412 (Precondition Failed) usually means in the Shopware <code>store API</code> context that the specified <code>accessToken</code> is incorrect or not correct for the specified <code>endpoint</code>. Check your <code>nuxt.config.ts</code> file, if you do not see an error, please try connecting directly to your <code>store API</code> endpoint using an API client.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// a part of nuxt.config.ts</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">shopware</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>\n<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">accessToken</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">SWSCBHFSNTVMAWNZDNFKSHLAYW</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// access token for corresponding sales channel</span></span>\n<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">endpoint</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://demo-frontends.shopware.store/store-api/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// endpoint where store-api is available</span></span>\n<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">devStorefrontUrl</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// to simulate a storefrontUrl which is used in registration process and should cover the domain settings for a sales channel</span></span>\n<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span></span>\n<span class="line"></span>\n<span class="line"></span></code></pre></div><h2 id="access-from-origin-127-0-0-1-3000-has-been-blocked-by-cors-policy" tabindex="-1">Access from origin 127.0.0.1:3000 has been blocked by CORS policy <a class="header-anchor" href="#access-from-origin-127-0-0-1-3000-has-been-blocked-by-cors-policy" aria-label="Permalink to &quot;Access from origin 127.0.0.1:3000 has been blocked by CORS policy&quot;">​</a></h2><p>Depending on your server, you may need to set the <code>Access-Control-Allow-Origin</code> header to access your server from an external origin. And yes, your local development server is also an external origin in this case. Also, have a look at this <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS/Errors/CORSMissingAllowOrigin" target="_blank" rel="noreferrer">documentation</a> from MDN.</p><h2 id="proxy-api-requests" tabindex="-1">Proxy API requests <a class="header-anchor" href="#proxy-api-requests" aria-label="Permalink to &quot;Proxy API requests&quot;">​</a></h2><p>If you&#39;re encountering issues related to Cross-Origin Resource Sharing (CORS) or if you wish to conceal the backend API URL, you can use Vite&#39;s proxy mechanism</p><h3 id="nuxt-example" tabindex="-1">Nuxt example <a class="header-anchor" href="#nuxt-example" aria-label="Permalink to &quot;Nuxt example&quot;">​</a></h3><p>Edit your <code>nuxt.config.ts</code> file and add:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre><code>  vite: {\n    server: {\n      proxy: {\n        &quot;/store-api&quot;: {\n          target: &quot;&lt;backend url&gt;&quot;,\n          changeOrigin: true,\n          secure: false,\n        },\n      },\n    },\n  },\n</code></pre></div><p>Modify the Shopware API endpoint to match your local frontend URL.</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre><code>  {\n    ...\n      shopware: {\n          endpoint: &quot;&lt;frontends &gt;store-api/&quot;,\n          ...\n      }\n  }\n</code></pre></div>',23)];const r=e(t,[["render",function(e,n,a,t,r,i){return o(),s("div",null,l)}]]);export{a as __pageData,r as default};
